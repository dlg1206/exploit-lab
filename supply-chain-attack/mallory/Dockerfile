# file: Dockerfile
# description: Create working enviroment for bad actor Mallory
#
# @author Derek Garcia
FROM node:22.13.1-alpine3.21
ENV MOCK_REGISTRY="mock-npm:4873"
ENV USER_CREATED=0
# utils for setting up registery
RUN apk add curl jq
# copy malcious npm package
RUN adduser -D -h /home/mallory mallory
WORKDIR /home/mallory
COPY --chown=mallory:mallory coookie-jar coookie-jar/
COPY --chown=mallory:mallory --chmod=775 setup.sh /setup.sh

USER mallory
ENTRYPOINT ["ash", "-c", ". /setup.sh; ash"]
